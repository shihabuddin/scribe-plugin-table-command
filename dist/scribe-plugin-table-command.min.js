!function(e,n){if("object"==typeof exports&&"object"==typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var t=n();for(var o in t)("object"==typeof exports?exports:e)[o]=t[o]}}(this,function(){return function(e){function n(o){if(t[o])return t[o].exports;var i=t[o]={exports:{},id:o,loaded:!1};return e[o].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}var t={};return n.m=e,n.c=t,n.p="",n(0)}([function(e,n,t){var o=t(1),i=t(6);e.exports=function(){return function(e){function n(n){for(;n&&!e.element.isBlockElement(n);)n=n.parentNode;return n}function t(n){if(13===n.keyCode){var t=new e.api.Selection,o=t.range,r=o.endContainer,l=i.findTable(e,r),a=i.findTableCell(e,r),c=Array.prototype.indexOf.call(e.el.childNodes,l)+1,d=null;a&&(n.preventDefault(),d=document.createElement("p"),l.nextSibling?e.el.insertBefore(d,l.nextSibling):e.el.appendChild(d),o.setStart(e.el.childNodes[c],0),o.collapse(!0),t.selection.removeAllRanges(),t.selection.addRange(o))}}function r(n){var t=n.target||n.toElement;if(t){var o=i.findTableCell(e,t),r=i.findTable(e,o);r&&(n.preventDefault(),n.stopPropagation(),a.show(r,o))}}var l=new e.api.Command("insertTable"),a=new o(e);l.nodeName="TABLE",l.execute=function(){var t=i.createTable(3,3);e.transactionManager.run(function(){var o=new e.api.Selection,r=n(o.range.endContainer),l=r.nextSibling;l&&e.el.contains(l)?e.el.insertBefore(t,l):e.el.appendChild(t);var a=t.childNodes[0],c=a.childNodes[0],d=c.childNodes[0];i.select(e,d)})},l.queryState=function(){var n=new e.api.Selection;return n.getContaining(function(e){return e.nodeName===this.nodeName}.bind(this))},l.queryEnabled=function(){return!0},e.el.addEventListener("keydown",t),e.el.addEventListener("contextmenu",r),e.commands.table=l}}},function(e,n,t){t(2);var o=t(6),i=[{id:0,text:"Insert row above"},{id:1,text:"Insert row below"},{id:2,text:"Insert column left"},{id:3,text:"Insert column right"},{id:4,text:"Delete row"},{id:5,text:"Delete column"},{id:6,text:"Delete table"}],r="scribe-table-context-menu",l="scribe-table-context-menu-action",a=function(e){for(var n=0,t=0;e;)n+=e.offsetTop,t+=e.offsetLeft,e!==document.body&&(n-=e.scrollTop),e=e.offsetParent;return{top:n,left:t}},c=function(e){return this.show=function(e,n){this.hide();var t=document.createElement("div"),o=a(n);t.className=r,t.style.top=o.top+20+"px",t.style.left=o.left+20+"px",i.forEach(function(o){var i=document.createElement("div");i.className=l,i.textContent=o.text,i.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),this.handleAction(e,n,o)}.bind(this)),t.appendChild(i)}.bind(this)),document.body.appendChild(t),document.addEventListener("click",function(e){3!==e.which&&this.hide()}.bind(this))},this.hide=function(){var e=document.getElementsByClassName(r)[0];e&&e.parentNode.removeChild(e),document.removeEventListener("click",this.hide)},this.handleAction=function(n,t,i){var r=o.findCellPosition(n,t);switch(this.hide(),i.id){case 0:o.insertRow(e,n,r.rowIndex);break;case 1:o.insertRow(e,n,r.rowIndex+1);break;case 2:o.insertColumn(e,n,r.columnIndex);break;case 3:o.insertColumn(e,n,r.columnIndex+1);break;case 4:o.removeRow(e,n,r.rowIndex);break;case 5:o.removeColumn(e,n,r.columnIndex);break;case 6:o.removeTable(e,n)}},this};e.exports=c},function(e,n){},,,,function(e,n){var t={createTableCell:function(){var e=document.createElement("td");return e},createTableRow:function(e){for(var n=document.createElement("tr"),o=0;o<e;o++)n.appendChild(t.createTableCell());return n},createTable:function(e,n){for(var o=document.createElement("table"),i=document.createElement("tbody"),r=0;r<e;r++)i.appendChild(t.createTableRow(n));return o.appendChild(i),o},getColumnCount:function(e){var n=e.childNodes[0],t=n.childNodes;return t[0].childNodes.length},getRowCount:function(e){var n=e.childNodes[0];return n.childNodes.length},findTable:function(e,n){for(;n&&n!==e.el&&"TABLE"!==n.nodeName;)n=n.parentNode;return n&&"TABLE"!==n.nodeName&&(n=null),n},findTableCell:function(e,n){for(;n&&n!==e.el&&"TD"!==n.nodeName;)n=n.parentNode;return n&&"TD"!==n.nodeName&&(n=null),n},findCellPosition:function(e,n){var t=e.childNodes[0],o=Array.prototype.slice.call(t.childNodes),i={rowIndex:-1,columnIndex:-1};return o.every(function(e,t){var o=Array.prototype.slice.call(e.childNodes);return o.every(function(e,o){return e!==n||(i={rowIndex:t,columnIndex:o},!1)}),i.rowIndex===-1}),i},insertRow:function(e,n,o){var i=t.getColumnCount(n),r=n.childNodes[0],l=r.childNodes[o],a=t.createTableRow(i);e.transactionManager.run(function(){r.insertBefore(a,l),this.select(e,a.childNodes[0])}.bind(this))},removeRow:function(e,n,o){if(1===this.getRowCount(n))return void this.removeTable(e,n);var i=n.childNodes[0],r=i.childNodes[o];e.transactionManager.run(function(){i.removeChild(r),o>=t.getRowCount(n)&&o--,this.select(e,i.childNodes[o].childNodes[0])}.bind(this))},insertColumn:function(e,n,o){var i=n.childNodes[0],r=Array.prototype.slice.call(i.childNodes);e.transactionManager.run(function(){r.forEach(function(e){var n=t.createTableCell();e.insertBefore(n,e.childNodes[o])}),this.select(e,i.childNodes[0].childNodes[o])}.bind(this))},removeColumn:function(e,n,t){var o=this.getColumnCount(n),i=n.childNodes[0],r=Array.prototype.slice.call(i.childNodes);return 1===o?void this.removeTable(e,n):void e.transactionManager.run(function(){r.forEach(function(e){e.removeChild(e.childNodes[t])}),this.select(e,i.childNodes[0].childNodes[0])}.bind(this))},removeTable:function(e,n){e.transactionManager.run(function(){e.el.removeChild(n),this.select(e,e.el.childNodes[0])}.bind(this))},select:function(e,n){var t=new e.api.Selection;t.range.setStart(n,0),t.range.collapse(!0),t.selection.removeAllRanges(),t.selection.addRange(t.range)}};e.exports=t}])});